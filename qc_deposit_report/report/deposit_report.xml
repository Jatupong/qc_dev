<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="deposit_report_id" >

        <t t-foreach="docs" t-as="o">
            <t t-call="web.basic_layout">
                <div class="header">
                    <style>
                        @font-face
                        {
                        font-family: Sarabun-Regular;
                        src: local('United'), url("/qc_deposit_report/static/font/Sarabun-Regular.ttf") format('opentype');
                        }
                        .font_fam{
                        font-family: Sarabun-Regular;
                        src: local('United'), url("/qc_deposit_report/static/font/Sarabun-Regular.ttf") format('opentype');
                        }
                        .word_wrap{
                        word-wrap: break-word;
                        overflow: hidden;
                        <!--background-color:#cccccc;-->
                        }
                        table.table-bordered{
                        border:1px solid black;
                        width: 100%;
                        }
                        table.table-bordered &gt; thead &gt; tr &gt; th{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; thead &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; tbody &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; tfoot &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        .font_size_32{
                        font-size: 32px;
                        line-height: 30px;
                        }
                        .font_size_28{
                        font-size: 28px;
                        line-height: 26px;
                        }
                        .font_size_22{
                        font-size: 22px;
                        line-height: 20px;
                        }
                        .font_size_20{
                        font-size: 20px;
                        line-height: 18px;
                        }
                        .font_size_18{
                        font-size: 18px;
                        line-height: 16px;
                        }
                        .font_size_16{
                        font-size: 16px;
                        line-height: 14px;
                        }
                        .font_size_14{
                        font-size: 14px;
                        line-height: 12px;
                        }
                        span{
                        line-height: inherit;
                        }
                    </style>

                    <table width="100%" class="font_fam table table-nobordered font_size_18">
                        <tr align="center">
                            <td><span t-field="o.company_id"/></td>
                        </tr>
                        <tr align="center">
                            <td><span>รายละเอียดเงินมัดจำลูกหนี้</span></td>
                        </tr>
                        <tr align="center">
                            <td><span>ณ </span><span t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M')"/></td>
                        </tr>
                    </table>


                </div>

                <div class="page">
                    <style>
                        @font-face
                        {
                        font-family: Sarabun-Regular;
                        src: local('United'), url("/qc_deposit_report/static/font/Sarabun-Regular.ttf") format('opentype');
                        }
                        .font_fam{
                        font-family: Sarabun-Regular;
                        src: local('United'), url("/qc_deposit_report/static/font/Sarabun-Regular.ttf") format('opentype');
                        }
                        table.table-bordered{
                        border:1px solid black;
                        width: 100%;
                        }
                        table.table-bordered &gt; thead &gt; tr &gt; th{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; thead &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; tbody &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; tfoot &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-nobordered{
                        margin:0px;
                        margin-top:0px;
                        margin-bottom:0px;
                        width: 100%;
                        }
                        table.table-nobordered &gt; thead &gt; tr &gt; th{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered &gt; thead &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered &gt; tbody &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered &gt; tfoot &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }

                        table.table-bordered {
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; thead &gt; tr &gt; th{
                        border:1px solid black;
                        vertical-align: middle;
                        text-align:center;
                        padding:3px;
                        }
                        table.table-bordered &gt; tbody &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; tfoot &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }

                        table.table-bordered-b {
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered-b &gt; thead &gt; tr &gt; th{
                        border:1px solid black;
                        vertical-align: middle;
                        text-align:center;
                        padding:3px;
                        }
                        table.table-bordered-b &gt; tbody &gt; tr &gt; td{
                        border:0px solid White;
                        border-left: 1px solid black;
                        padding:3px;
                        }
                        table.table-bordered-b &gt; tfoot &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }

                        table.table-nobordered-b{
                        margin:0px;
                        width: 100%;
                        }
                        table.table-nobordered-b &gt; thead &gt; tr &gt; th{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered-b &gt; thead &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered-b &gt; tbody &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered-b &gt; tfoot &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }
                        .word_wrap{
                        word-wrap: break-word;
                        <!--background-color:#cccccc;-->
                        }
                        .font_size_32{
                        font-size: 32px;
                        line-height: 30px;
                        }
                        .font_size_28{
                        font-size: 28px;
                        line-height: 26px;
                        }
                        .font_size_22{
                        font-size: 22px;
                        line-height: 20px;
                        }
                        .font_size_20{
                        font-size: 20px;
                        line-height: 18px;
                        }
                        .font_size_18{
                        font-size: 18px;
                        line-height: 16px;
                        }
                        .font_size_16{
                        font-size: 16px;
                        line-height: 14px;
                        }
                        .font_size_14{
                        font-size: 14px;
                        line-height: 12px;
                        }
                    </style>

                    <table width="100%" class="font_fam table table-bordered font_size_14">
                        <t t-foreach="partner_ids" t-as="partner">
                            <tr>
                                <td colspan="16">
                                    <span t-esc="partner.name"/>
                                </td>
                            </tr>
                            <tr style="text-align:center;">
                                <td rowspan="2">
                                    <span>วันที่รับเงิน</span>
                                </td>
                                <td rowspan="2">
                                    <span>ทีมขาย</span>
                                </td>
                                <td rowspan="2">
                                    <span>PI.NO</span>
                                </td>
                                <td rowspan="2">
                                    <span>เลขที่เอกสาร</span>
                                </td>
                                <td rowspan="2">
                                    <span>จำนวนเงิน<br/>ตาม PI</span>
                                </td>
                                <td rowspan="2">
                                    <span>เงื่อนไข</span>
                                </td>
                                <td rowspan="2">
                                    <span>สกุลเงิน</span>
                                </td>
                                <td rowspan="2">
                                    <span>จำนวนเงิน(ตปท)</span>
                                </td>
                                <td rowspan="2">
                                    <span>Ex.Rate</span>
                                </td>
                                <td rowspan="2">
                                    <span>จำนวนเงิน(บาท)</span>
                                </td>
                                <td>
                                    <span>ค่าธรรมเนียม</span>
                                </td>
                                <td>
                                    <span>รับจริง</span>
                                </td>
                                <td>
                                    <span>จำนวนเงินที่หัก</span>
                                </td>
                                <td>
                                    <span>มัดจำ</span>
                                </td>
                                <td colspan="2">
                                    <span>คงเหลือ</span>
                                </td>
                                <td rowspan="2">
                                    <span>Note</span>
                                </td>
                            </tr>
                            <tr style="text-align:center;">
                                <td>
                                    <span>(ตปท)</span>
                                </td>
                                <td>
                                    <span>(ตปท)</span>
                                </td>
                                <td>
                                    <span>(ตปท)</span>
                                </td>
                                <td>
                                    <span>(บาท)</span>
                                </td>

                                <td>
                                    <span>(ตปท)</span>
                                </td>
                                <td>
                                    <span>(บาท)</span>
                                </td>
                            </tr>
                            <t t-set="sale_order_ids_by_partner" t-value="sale_order_ids.filtered(lambda x: x.id == partner.id)"/>
                            <t t-foreach="sale_order_ids_by_partner" t-as="sale">
                                <t t-foreach="sale.invoice_ids" t-as="inv">
                                    <tr>
                                        <td>
                                            <span t-esc="inv.invoice_date"/>
                                        </td>
                                        <td>
                                            <span t-esc="inv.team_id.name"/>
                                        </td>
                                        <td>
                                            <span t-esc="sale.name"/>
                                        </td>
                                        <td>
                                            <span t-esc="inv.name"/>
                                        </td>
                                        <td>
                                            <t t-set="sale_amount_total" t-value="sale.amount_total"/>
                                            <span t-esc="sale_amount_total"/>
                                        </td>
                                        <td>
                                            <span t-field="inv.invoice_payment_term_id"/>
                                        </td>
                                        <t t-if="inv.company_id.currency_id != inv.currency_id">
                                            <td>
                                                <span t-esc="inv.currency_id.name"/>
                                            </td>
                                            <td>
                                                <span t-esc="inv.amount_total"/>
                                            </td>
                                            <td>
                                                <t t-set="currency_rate" t-value="inv.currency_id._get_rates(inv.company_id, inv.invoice_date)"/>
                                                <span t-esc="currency_rate"/>
                                            </td>
                                            <td>
                                                <span t-esc="inv.amount_total"/>
                                            </td>
                                        </t>
                                        <t t-else="">
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td>
                                                <span t-esc="inv.amount_total"/>
                                            </td>
                                        </t>
                                        <!--                                        ค่าธรรมเนียม-->
                                        <td>
                                            <t t-set="fee_amount" t-value="0.0"/>
                                            <span t-esc="fee_amount"/>
                                        </td>
                                        <!--                                        รับจริง-->
                                        <t t-if="inv.company_id.currency_id != inv.currency_id">
                                            <td>
                                                <span t-esc="inv.amount_total"/>
                                            </td>
                                        </t>
                                        <t t-else="">
                                            <td>
                                                <span t-esc="inv.amount_total"/>
                                            </td>
                                        </t>
                                        <!--                                        จำนวนเงินที่หัก-->
                                        <td>
                                            <span t-esc="inv.amount_total"/>
                                        </td>
                                        <!--                                        มัดจำ-->
                                        <t t-if="inv.company_id.currency_id != inv.currency_id">
                                            <td>
                                                <span t-esc="inv.amount_total"/>
                                            </td>
                                        </t>
                                        <t t-else="">
                                            <td>
                                                <span t-esc="inv.amount_total"/>
                                            </td>
                                        </t>
                                        <!--                                        คงเหลือ-->
                                        <t t-if="inv.company_id.currency_id != inv.currency_id">
                                            <td>
                                                <span t-esc="sale_amount_total - inv.amount_total"/>
                                            </td>
                                        </t>
                                        <t t-else="">
                                            <td>
                                                <span t-esc="sale_amount_total - inv.amount_total"/>
                                            </td>
                                        </t>
                                        <td>
                                            <span t-esc="sale_amount_total - inv.amount_total"/>
                                        </td>
                                        <td>
                                            <span t-esc="inv.narration"/>
                                        </td>
                                    </tr>
                                </t>
                            </t>
                        </t>


                    </table>

                </div>
            </t>
        </t>

    </template>

</odoo>