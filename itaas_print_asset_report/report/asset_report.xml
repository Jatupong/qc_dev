<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <template id="asset_report_id">
            <t t-foreach="docs" t-as="doc">
                <t t-call="web.basic_layout">
                    <div class="header">
                        <style>
                            @font-face
                            {
                            font-family: SarabunPSK;
                            src: local('United'), url("/itaas_print_asset_report/static/THSarabun.ttf") format('opentype');
                            }
                            .font_fam{
                            font-family: SarabunPSK;
                            src: local('United'), url("/itaas_print_asset_report/static/THSarabun.ttf") format('opentype');
                            }
                            table.table-bordered{
                            border:1px solid black;
                            width: 100%;
                            font-family: SarabunPSK;
                            src: local('United'), url("/itaas_print_asset_report/static/THSarabun.ttf") format('opentype');
                            }
                            table.table-bordered &gt; thead &gt; tr &gt; th{
                            border:1px solid black;
                            padding:3px;
                            }
                            table.table-bordered &gt; thead &gt; tr &gt; td{
                            border:1px solid black;
                            padding:3px;
                            }
                            table.table-bordered &gt; tbody &gt; tr &gt; td{
                            border:1px solid black;
                            padding:3px;
                            height:35px;
                            }
                            table.table-bordered &gt; tfoot &gt; tr &gt; td{
                            border:1px solid black;
                            padding:3px;
                            }
                            table.table-nobordered{
                            margin:0px;
                            margin-top:10px;
                            margin-bottom:5px;
                            width: 100%;
                            font-family: SarabunPSK;
                            src: local('United'), url("/itaas_print_asset_report/static/THSarabun.ttf") format('opentype');
                            }
                            table.table-nobordered &gt; thead &gt; tr &gt; th{
                            border:1px solid white;
                            padding:0px;
                            }
                            table.table-nobordered &gt; thead &gt; tr &gt; td{
                            border:1px solid white;
                            padding:0px;
                            }
                            table.table-nobordered &gt; tbody &gt; tr &gt; td{
                            border:1px solid white;
                            padding:0px;
                            }
                            table.table-nobordered &gt; tfoot &gt; tr &gt; td{
                            border:1px solid white;
                            padding:0px;
                            }
                            .td_top{
                            border-top:#000 solid 1px;
                            }
                            .td_left{
                            border-left:#000 solid 1px;
                            }
                            .td_right{
                            border-right:#000 solid 1px;
                            }
                            .td_bott{
                            border-bottom:#000 solid 1px;
                            }

                        </style>
                        <br/>
                        <br/>
                        <div class="col-xs-12" style="text-align: right">
                            <font style="font-size: 18px;">
                                <!--<img t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s' % ('Code128', doc.barcode, 600, 100)" style="width:300px;height:50px;"/>-->
                                <div t-field="doc.barcode" t-options="{'widget': 'barcode', 'symbology': 'auto', 'width': 300, 'height': 60, 'quiet': 0, 'img_style': 'height:35px;'}"/>
                            </font>
                        </div>

                        <table width="100%" class="font_fam td_bott" style="border: 1px solid transparent">
                            <!--                        <table style="width:100%">-->
                            <tr>

                                <td style="width:15%">
                                    <strong>ชื่อสินทรัพย์:</strong>
                                </td>
                                <td style="width:50%">
                                    <span t-field="doc.name"/>
                                </td>
                                <td style="width:15%">
                                    <strong>รหัสสินทรัพย์:</strong>
                                </td>
                                <td style="width:20%">
                                    <span t-field="doc.code"/>
                                </td>

                            </tr>
                            <tr>

                                <td style="width:15%">
                                    <strong>วันที่ซื้อ:</strong>
                                </td>
                                <td style="width:50%">
                                    <span t-field="doc.acquisition_date"/>
                                </td>
                                <td style="width:15%">
                                    <strong>ราคาซื้อ:</strong>
                                </td>
                                <td style="width:20%">
                                    <span t-field="doc.original_value"/>
                                </td>

                            </tr>
                            <tr>

                                <td style="width:15%">
                                    <strong>วันที่บันทึกสินทรัพย์:</strong>
                                </td>
                                <td style="width:50%">
                                    <span t-field="doc.prorata_date"/>
                                </td>
                                <td style="width:15%">
                                    <strong>มูลค่าสินทรัพย์:</strong>
                                </td>
                                <td style="width:20%">
                                    <span t-esc="'{0:,.2f}'.format(float(abs(doc.book_value)))"/>

                                </td>

                            </tr>
                            <tr>

                                <td style="width:15%">
                                    <strong>มูลค่าซาก:</strong>
                                </td>
                                <td style="width:20%">
                                    <span t-esc="'{0:,.2f}'.format(float(abs(doc.salvage_value)))"/>

                                </td>
                                <td style="width:15%">
                                    <strong>ค่าเสื่อมราคาสะสม:</strong>
                                </td>
                                <td style="width:20%">
                                    <span t-esc="'{0:,.2f}'.format(float(abs(doc.original_value - doc.value_residual)))"/>
                                </td>


                            </tr>
                            <tr>

                                <td style="width:15%">
                                    <strong>ประเภทสินทรัพย์:</strong>
                                </td>
                                <td style="width:50%">
                                    <span t-field="doc.model_id.name"/>
                                </td>
                                <td style="width:15%">
                                    <strong>มูลค่าสินทรัพย์สุทธิ:</strong>
                                </td>
                                <td style="width:20%">
                                    <span t-esc="'{0:,.2f}'.format(float(abs(doc.value_residual)))"/>
                                </td>

                            </tr>
                            <tr>

                                <td style="width:15%">
                                    <strong>พนักงาน:</strong>
                                </td>
                                <td style="width:50%">
                                    <span t-field="doc.employee_id.name"/>
                                </td>
                                <td style="width:15%">
                                    <strong>แผนก:</strong>
                                </td>
                                <td style="width:20%">
                                    <span t-field="doc.department_id.name"/>
                                </td>

                            </tr>
                            <tr>

                                <td style="width:15%">
                                    <strong>Serial Number:</strong>
                                </td>
                                <td style="width:50%">
                                    <span t-field="doc.serial_number"/>
                                </td>
                                <td style="width:15%">
                                    <strong>สถานที่ตั้ง:</strong>
                                </td>
                                <td style="width:20%">
                                    <span t-field="doc.location_id.name"/>
                                </td>

                            </tr>
                        </table>
                        <font style="font-size: 24px;font-family:TH SarabunPSK;">
                           <br/>
                            <strong>ข้อมูลการคิดค่าเสื่อมราคา</strong>
                            <br/>
                        </font>
                        <table width="100%" class="table-bordered">
                            <!--                        <table class="table table-bordered1" style="width:100%">-->
                            <tbody>
                                <tr>

                                    <td style="width: 25%; text-align: center">
                                        <span>วิธีการคำนวน</span>
                                    </td>
                                    <td style="width: 25%; text-align: center">
                                        <span>วิธีคิดจำนวนรอบค่าเสื่อม</span>
                                    </td>
                                    <td style="width: 25%; text-align: center">
                                        <span>จำนวนรอบคิดค่าเสื่อม</span>
                                    </td>
                                    <td style="width: 25%; text-align: center">
                                        <span>จำนวนเดือนต่อรอบคิดค่าเสื่อม</span>
                                    </td>

                                </tr>
                                <tr>

                                    <td style="width: 25%; text-align: center">
                                        <span t-field="doc.method"/>
                                    </td>
                                    <td style="width: 25%; text-align: center">
                                        <span t-esc="int(100 / (doc.model_id.method_number/12))"/>%
                                    </td>
                                    <td style="width: 25%; text-align: center">
                                        <span t-field="doc.method_number"/>
                                    </td>
                                    <td style="width: 25%; text-align: center">
                                        <t t-if="doc.method_period == '1'">
                                            <span>1 เดือน</span>
                                        </t>
                                        <t t-if="doc.method_period == '12'">
                                            <span>12 เดือน</span>
                                        </t>

                                    </td>

                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="page">
                        <style>
                            @font-face
                            {
                            font-family: SarabunPSK;
                            src: local('United'), url("/itaas_print_asset_report/static/THSarabun.ttf") format('opentype');
                            }
                            .font_fam{
                            font-family: SarabunPSK;
                            src: local('United'), url("/itaas_print_asset_report/static/THSarabun.ttf") format('opentype');
                            }
                            table.table-bordered{
                            border:1px solid black;
                            width: 100%;
                            font-family: SarabunPSK;
                            src: local('United'), url("/itaas_print_asset_report/static/THSarabun.ttf") format('opentype');
                            }
                            table.table-bordered &gt; thead &gt; tr &gt; th{
                            border:1px solid black;
                            padding:3px;
                            }
                            table.table-bordered &gt; thead &gt; tr &gt; td{
                            border:1px solid black;
                            padding:3px;
                            }
                            table.table-bordered &gt; tbody &gt; tr &gt; td{
                            border:1px solid black;
                            padding:3px;
                            height:35px;
                            }
                            table.table-bordered &gt; tfoot &gt; tr &gt; td{
                            border:1px solid black;
                            padding:3px;
                            }
                            table.table-nobordered{
                            margin:0px;
                            margin-top:10px;
                            margin-bottom:5px;
                            width: 100%;
                            font-family: SarabunPSK;
                            src: local('United'), url("/itaas_print_asset_report/static/THSarabun.ttf") format('opentype');
                            }
                            table.table-nobordered &gt; thead &gt; tr &gt; th{
                            border:1px solid white;
                            padding:0px;
                            }
                            table.table-nobordered &gt; thead &gt; tr &gt; td{
                            border:1px solid white;
                            padding:0px;
                            }
                            table.table-nobordered &gt; tbody &gt; tr &gt; td{
                            border:1px solid white;
                            padding:0px;
                            }
                            table.table-nobordered &gt; tfoot &gt; tr &gt; td{
                            border:1px solid white;
                            padding:0px;
                            }
                            .td_top{
                            border-top:#000 solid 1px;
                            }
                            .td_left{
                            border-left:#000 solid 1px;
                            }
                            .td_right{
                            border-right:#000 solid 1px;
                            }
                            .td_bott{
                            border-bottom:#000 solid 1px;
                            }
                        </style>
                        <!--                        <div class="content">-->
                        <font style="font-size: 24px;font-family:TH SarabunPSK;">
                            <br/>
                            <strong>ตารางค่าเสื่อมราคา</strong>
                            <br/>
                        </font>
                        <table class="table-bordered">
                            <thead>
                                <tr>
                                    <th style="text-align:center">
                                        ลำดับ
                                    </th>
                                    <th style="text-align:center">
                                        วันตัดค่าเสื่อมราคา
                                    </th>
                                    <th style="text-align:center">
                                        ค่าเสื่อมราคาสะสม
                                    </th>
                                    <th style="text-align:center">
                                        ค่าเสื่อมราคา
                                    </th>

                                    <th style="text-align:center">
                                        มูลค่าคงเหลือ
                                    </th>
                                    <th style="text-align:center">
                                        สถานะ
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="i" t-value="1"/>
                                <t t-foreach="doc.depreciation_move_ids" t-as="l">
                                    <tr>
                                        <td style="text-align:center">

                                            <span t-esc="i"/>

                                        </td>
                                        <t t-set="i" t-value="i+1"/>
                                        <td>

                                            <span t-field="l.date"/>

                                        </td>
                                        <td style="text-align:center">

                                            <span t-field="l.asset_depreciated_value"/>

                                        </td>
                                        <td style="text-align:center">

                                            <span t-field="l.amount_total"/>

                                        </td>
                                        <td style="text-align:right">

                                            <span t-field="l.asset_remaining_value"/>

                                        </td>
                                        <td style="text-align:center">

                                            <t t-if="l.state == 'posted'">
                                                <span>Posted</span>
                                            </t>
                                            <t t-if="l.state != 'posted'">
                                                <span>Draft</span>
                                            </t>

                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>

                        <font style="font-size: 24px;font-family:TH SarabunPSK;">
                            <br/>
                            <strong>ตารางการโอนย้าย</strong>
                            <br/>
                        </font>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th style="text-align:center">
                                        อ้างอิง
                                    </th>
                                    <th style="text-align:center">
                                        วันที่
                                    </th>
                                    <th style="text-align:center">
                                        จากตำแหน่ง
                                    </th>
                                    <th style="text-align:center">
                                        ไปตำแหน่ง
                                    </th>
                                    <th style="text-align:center">
                                        จากแผนก
                                    </th>
                                    <th style="text-align:center">
                                        ไปแผนก
                                    </th>
                                    <th style="text-align:center">
                                        จากพนักงาน
                                    </th>
                                    <th style="text-align:center">
                                        ไปพนักงาน
                                    </th>
                                    <th style="text-align:center">
                                        จากประเภท
                                    </th>
                                    <th style="text-align:center">
                                        ไปประเภท
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="i" t-value="1"/>
                                <t t-foreach="doc.asset_move_ids" t-as="l">
                                    <tr>
                                        <td style="text-align:center">

                                            <span t-esc="l.name"/>

                                        </td>
                                        <t t-set="i" t-value="i+1"/>
                                        <td>

                                            <span t-field="l.date"/>

                                        </td>
                                        <td style="text-align:center">

                                            <span t-field="l.from_location_id"/>

                                        </td>
                                        <td style="text-align:center">

                                            <span t-field="l.to_location_id"/>

                                        </td>
                                        <td style="text-align:right">

                                            <span t-field="l.from_department_id"/>

                                        </td>
                                        <td style="text-align:right">

                                            <span t-field="l.to_department_id"/>

                                        </td>

                                        <td style="text-align:right">

                                            <span t-field="l.from_employee_id"/>

                                        </td>
                                        <td style="text-align:right">

                                            <span t-field="l.to_employee_id"/>

                                        </td>

                                        <td style="text-align:right">

                                            <span t-field="l.from_model_id"/>

                                        </td>
                                        <td style="text-align:right">

                                            <span t-field="l.to_model_id"/>

                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                    <!--                    </div>-->
                </t>
            </t>
        </template>


        <record id="paperformat_A4_Zero_Asset" model="report.paperformat">
            <field name="name">A4_Zero_Asset</field>
            <field name="default" eval="False"/>
            <field name="format">A4</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">100</field>
            <field name="margin_bottom">10</field>
            <field name="margin_left">7</field>
            <field name="margin_right">7</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">95</field>
            <field name="dpi">90</field>
        </record>

        <report
                id="asset_report"
                model="account.asset"
                menu="True"
                report_type="qweb-pdf"
                string="Asset Report"
                paperformat="paperformat_A4_Zero_Asset"
                name="itaas_print_asset_report.asset_report_id"
                file="itaas_print_asset_report.asset_report_id"
        />
    </data>
</odoo>
