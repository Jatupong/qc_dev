<?xml version="1.0" encoding="utf-8"?>
<odoo>
        <template id="qc_sale_production_report_id" >

                <t t-foreach="docs" t-as="o">
                        <t t-set="mrp_production_ids" t-value="o.mrp_production_ids"/>

                        <t t-call="web.basic_layout">
                                <div class="header">
                                        <style>
                                                @font-face
                                                {
                                                font-family: Sarabun-Regular;
                                                src: local('United'), url("/qc_production_report/static/font/Sarabun-Regular.ttf") format('opentype');
                                                }
                                                .font_fam{
                                                font-family: Sarabun-Regular;
                                                src: local('United'), url("/qc_production_report/static/font/Sarabun-Regular.ttf") format('opentype');
                                                }
                                                table.table-bordered{
                                                border:1px solid black;
                                                width: 100%;
                                                }
                                                table.table-bordered &gt; thead &gt; tr &gt; th{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; thead &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tbody &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-nobordered{
                                                margin:0px;
                                                margin-top:0px;
                                                margin-bottom:0px;
                                                width: 100%;
                                                }
                                                table.table-nobordered &gt; thead &gt; tr &gt; th{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered &gt; thead &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered &gt; tbody &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }

                                                table.table-bordered {
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; thead &gt; tr &gt; th{
                                                border:1px solid black;
                                                vertical-align: middle;
                                                text-align:center;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tbody &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }

                                                table.table-bordered-b {
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered-b &gt; thead &gt; tr &gt; th{
                                                border:1px solid black;
                                                vertical-align: middle;
                                                text-align:center;
                                                padding:3px;
                                                }
                                                table.table-bordered-b &gt; tbody &gt; tr &gt; td{
                                                border:0px solid White;
                                                border-left: 1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered-b &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }

                                                table.table-nobordered-b{
                                                margin:0px;
                                                width: 100%;
                                                }
                                                table.table-nobordered-b &gt; thead &gt; tr &gt; th{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered-b &gt; thead &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered-b &gt; tbody &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered-b &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                .word_wrap{
                                                word-wrap: break-word;
                                                <!--background-color:#cccccc;-->
                                                }
                                                .font_size_32{
                                                font-size: 32px;
                                                line-height: 30px;
                                                }
                                                .font_size_28{
                                                font-size: 28px;
                                                line-height: 26px;
                                                }
                                                .font_size_22{
                                                font-size: 22px;
                                                line-height: 20px;
                                                }
                                                .font_size_20{
                                                font-size: 20px;
                                                line-height: 18px;
                                                }
                                                .font_size_18{
                                                font-size: 18px;
                                                line-height: 16px;
                                                }
                                                .font_size_16{
                                                font-size: 16px;
                                                line-height: 14px;
                                                }
                                                .font_size_14{
                                                font-size: 14px;
                                                line-height: 12px;
                                                }
                                                .font_size_12{
                                                font-size: 12px;
                                                line-height: 10px;
                                                }
                                        </style>

                                        <table width="100%" class="font_fam table table-bordered font_size_14">
                                                <tr>
                                                        <td align="center" width="20%">
                                                                <span>วันที่พิมพ์รายงาน</span><br/>
                                                                <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M')"/>
                                                        </td>
                                                        <td align="center" class="font_size_20" width="60%">
                                                                <span t-field="o.company_id.english_name"/><br/>
                                                                <span>ใบสั่งผลิต - ฝ่ายการตลาด</span>
                                                        </td>
                                                        <td align="center" width="20%">
                                                                <span t-field="o.company_id.production_order_no_form"/><br/>
                                                                <span class="font_size_12">แก้ไขครั้งที่ 0 : 01 กันยายน 2563</span><br/>
                                                                <span>หน้าที่ </span>
                                                                <span class="page"/>/<span class="topage"/>
                                                        </td>
                                                </tr>
                                        </table>

                                        <table width="100%" class="font_fam table table-nobordered font_size_14">
                                                <tr>
                                                        <td width="15%">เลขที่สั่งผลิต</td>
                                                        <td width="35%">:
                                                                <t t-if="len(o.order_line.manufacturing_request_ids)!=0">
                                                                        <span t-field="o.order_line.manufacturing_request_ids[0].number"/>
                                                                </t>
                                                                <t t-else="">
                                                                        <t t-if="o.order_line.manufacturing_request_ids.number">
                                                                              <span t-field="o.order_line.manufacturing_request_ids.number"/>
                                                                        </t>
                                                                </t>
                                                        </td>

                                                        <td width="15%">วันที่</td>
                                                        <td width="35%">:
                                                                <span t-field="o.date_order" t-options="{'widget': 'date', 'format': 'dd/MM/yyy'}"/>
                                                        </td>
                                                </tr>
                                                <tr>
                                                        <td>ชื่อลูกค้า</td>
                                                        <td>:
                                                                <span t-field="o.partner_id"/>
                                                        </td>
                                                        <td>กำหนดส่ง</td>
                                                        <td>:
                                                                <span t-field="o.commitment_date" t-options="{'widget': 'date', 'format': 'dd/MM/yyy'}"/>
                                                        </td>
                                                </tr>
                                                <tr>
                                                        <td>P/O No.</td>
                                                        <td>:
                                                                <span t-field="o.id_po"/>
                                                        </td>
                                                        <td>P/I No.</td>
                                                        <td>:
                                                                <span t-field="o.name"/>
                                                        </td>
                                                </tr>
                                                <tr>
                                                        <td>Shipping Mark</td>
                                                        <td>:
                                                                <span t-field="o.shipping_mark"/>
                                                        </td>
                                                        <td>Packing</td>
                                                        <td>:
                                                                <span t-field="o.box_type"/>
                                                        </td>
                                                </tr>
                                                <tr>
                                                        <td>Backstamp</td>
                                                        <td>:
                                                                <span t-field="o.logo"/>
                                                        </td>
                                                        <td/>
                                                        <td/>
                                                </tr>
                                        </table>
                                </div>
                                <div class="page">
                                        <style>
                                                @font-face
                                                {
                                                font-family: Sarabun-Regular;
                                                src: local('United'), url("/qc_production_report/static/font/Sarabun-Regular.ttf") format('opentype');
                                                }
                                                .font_fam{
                                                font-family: Sarabun-Regular;
                                                src: local('United'), url("/qc_production_report/static/font/Sarabun-Regular.ttf") format('opentype');
                                                }
                                                table.table-bordered{
                                                border:1px solid black;
                                                width: 100%;
                                                }
                                                table.table-bordered &gt; thead &gt; tr &gt; th{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; thead &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tbody &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-nobordered{
                                                margin:0px;
                                                margin-top:0px;
                                                margin-bottom:0px;
                                                width: 100%;
                                                }
                                                table.table-nobordered &gt; thead &gt; tr &gt; th{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered &gt; thead &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered &gt; tbody &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }

                                                table.table-bordered {
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; thead &gt; tr &gt; th{
                                                border:1px solid black;
                                                vertical-align: middle;
                                                text-align:center;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tbody &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }

                                                table.table-bordered-b {
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered-b &gt; thead &gt; tr &gt; th{
                                                border:1px solid black;
                                                vertical-align: middle;
                                                text-align:center;
                                                padding:3px;
                                                }
                                                table.table-bordered-b &gt; tbody &gt; tr &gt; td{
                                                border:0px solid White;
                                                border-left: 1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered-b &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }

                                                table.table-nobordered-b{
                                                margin:0px;
                                                width: 100%;
                                                }
                                                table.table-nobordered-b &gt; thead &gt; tr &gt; th{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered-b &gt; thead &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered-b &gt; tbody &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered-b &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                .word_wrap{
                                                word-wrap: break-word;
                                                <!--background-color:#cccccc;-->
                                                }
                                                .font_size_32{
                                                font-size: 32px;
                                                line-height: 30px;
                                                }
                                                .font_size_28{
                                                font-size: 28px;
                                                line-height: 26px;
                                                }
                                                .font_size_22{
                                                font-size: 22px;
                                                line-height: 20px;
                                                }
                                                .font_size_20{
                                                font-size: 20px;
                                                line-height: 18px;
                                                }
                                                .font_size_18{
                                                font-size: 18px;
                                                line-height: 16px;
                                                }
                                                .font_size_16{
                                                font-size: 16px;
                                                line-height: 14px;
                                                }
                                                .font_size_14{
                                                font-size: 14px;
                                                line-height: 12px;
                                                }
                                        </style>

                                        <t t-set="i_num" t-value="0"/>
                                        <t t-set="qty_total" t-value="0.0"/>
                                        <table width="100%" class="font_fam table table-bordered font_size_14" style="border-color:black;">
                                                <thead style="backgroup-color:#bbbbbb;">
                                                        <tr>
                                                                <th rowspan="2">
                                                                        <span>ลำดับ</span>
                                                                </th>
                                                                <th rowspan="2">
                                                                        <span>รหัส</span>
                                                                </th>
                                                                <th rowspan="2">
                                                                        <span>รายการ</span>
                                                                </th>
                                                                <th rowspan="2">
                                                                        <span>โลโก้</span>
                                                                </th>
                                                                <th rowspan="2">
                                                                        <span>ตกแต่ง</span>
                                                                </th>
                                                                <th colspan="2">
                                                                        <span>กล่อง</span>
                                                                </th>
                                                                <th rowspan="2">
                                                                        <span>จำนวน</span>
                                                                </th>
                                                        </tr>
                                                        <tr>
                                                                <th>
                                                                        <span>ใน</span>
                                                                </th>
                                                                <th>
                                                                        <span>นอก</span>
                                                                </th>
                                                        </tr>
                                                </thead>
                                                <tbody>
                                                        <t t-foreach="o.order_line.filtered(lambda x:x.display_type not in ['line_note','line_section'] and x.product_template_id.detailed_type not in ['service','consu'])" t-as="line">
                                                                <t t-set="i_num" t-value="i_num + 1"/>
                                                                <t t-set="product_set_ids" t-value="o.sale_order_set_line_ids.filtered(lambda x: x.product_set_id == line.product_id)"/>
                                                                <tr>
                                                                        <td align="center">
                                                                                <span t-esc="i_num"/>
                                                                        </td>
                                                                        <td>
                                                                                <span t-field="line.product_id.default_code"/>
                                                                        </td>
                                                                        <td>
                                                                                <span t-field="line.product_id.name"/>
                                                                        </td>
                                                                        <td align="center">
                                                                                <t t-set="product_template_variant_logo" t-value="line.product_id.product_template_variant_value_ids.filtered(lambda x:x.attribute_id.name == 'โลโก้')"/>
                                                                                <t t-if="product_template_variant_logo">
                                                                                        <span t-esc="', '.join(product_template_variant_logo.mapped('name'))"/>
                                                                                </t>
                                                                        </td>
                                                                        <td>
                                                                                <t t-set="product_template_variant_logo" t-value="line.product_id.product_template_variant_value_ids.filtered(lambda x:x.attribute_id.name == 'ตกแต่ง')"/>
                                                                                <t t-if="product_template_variant_logo">
                                                                                        <span t-esc="', '.join(product_template_variant_logo.mapped('name'))"/>
                                                                                </t>
                                                                        </td>
                                                                        <td align="right">
                                                                                <t t-set="product_set_qty" t-value="1.0"/>
                                                                                <t t-if="product_set_ids">
                                                                                        <t t-set="product_set_qty" t-value="sum(product_set_ids.mapped('original_set_qty'))"/>
                                                                                        <span t-esc="'{0:,.2f}'.format(product_set_qty)"/>
                                                                                </t>
                                                                        </td>
                                                                        <td align="right">
                                                                                <span t-field="line.product_uom_qty"/>
                                                                        </td>
                                                                        <t t-set="product_qty" t-value="line.product_uom_qty * product_set_qty"/>
                                                                        <td align="right">
                                                                                <t t-set="qty_total" t-value="qty_total + product_qty"/>
                                                                                <span t-esc="'{0:,.2f}'.format(product_qty)"/>
                                                                                <span t-field="line.product_uom"/>
                                                                        </td>
                                                                </tr>
                                                        </t>
                                                </tbody>
                                                <tfoot>
                                                        <tr>
                                                                <td colspan="5" align="center">
                                                                        <span>รวม</span>
                                                                </td>
                                                                <td colspan="3" align="center">
                                                                        <span t-esc="'{0:,.2f}'.format(qty_total)"/>
                                                                </td>
                                                        </tr>
                                                </tfoot>
                                        </table>
                                        <div class="font_fam font_size_14">
                                                <span>หมายเหตุ</span>
                                                <span t-esc="o.note"/>
                                        </div>

                                </div>
                                <div class="footer">
                                        <style>
                                                @font-face
                                                {
                                                font-family: Sarabun-Regular;
                                                src: local('United'), url("/qc_production_report/static/font/Sarabun-Regular.ttf") format('opentype');
                                                }
                                                .font_fam{
                                                font-family: Sarabun-Regular;
                                                src: local('United'), url("/qc_production_report/static/font/Sarabun-Regular.ttf") format('opentype');
                                                }
                                                table.table-bordered{
                                                border:1px solid black;
                                                width: 100%;
                                                }
                                                table.table-bordered &gt; thead &gt; tr &gt; th{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; thead &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tbody &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-nobordered{
                                                margin:0px;
                                                margin-top:0px;
                                                margin-bottom:0px;
                                                width: 100%;
                                                }
                                                table.table-nobordered &gt; thead &gt; tr &gt; th{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered &gt; thead &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered &gt; tbody &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }

                                                table.table-bordered {
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; thead &gt; tr &gt; th{
                                                border:1px solid black;
                                                vertical-align: middle;
                                                text-align:center;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tbody &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }

                                                table.table-bordered-b {
                                                border:1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered-b &gt; thead &gt; tr &gt; th{
                                                border:1px solid black;
                                                vertical-align: middle;
                                                text-align:center;
                                                padding:3px;
                                                }
                                                table.table-bordered-b &gt; tbody &gt; tr &gt; td{
                                                border:0px solid White;
                                                border-left: 1px solid black;
                                                padding:3px;
                                                }
                                                table.table-bordered-b &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid black;
                                                padding:3px;
                                                }

                                                table.table-nobordered-b{
                                                margin:0px;
                                                width: 100%;
                                                }
                                                table.table-nobordered-b &gt; thead &gt; tr &gt; th{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered-b &gt; thead &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered-b &gt; tbody &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                table.table-nobordered-b &gt; tfoot &gt; tr &gt; td{
                                                border:1px solid white;
                                                padding:0px;
                                                }
                                                .word_wrap{
                                                word-wrap: break-word;
                                                <!--background-color:#cccccc;-->
                                                }
                                                .font_size_32{
                                                font-size: 32px;
                                                line-height: 30px;
                                                }
                                                .font_size_28{
                                                font-size: 28px;
                                                line-height: 26px;
                                                }
                                                .font_size_22{
                                                font-size: 22px;
                                                line-height: 20px;
                                                }
                                                .font_size_20{
                                                font-size: 20px;
                                                line-height: 18px;
                                                }
                                                .font_size_18{
                                                font-size: 18px;
                                                line-height: 16px;
                                                }
                                                .font_size_16{
                                                font-size: 16px;
                                                line-height: 14px;
                                                }
                                                .font_size_14{
                                                font-size: 14px;
                                                line-height: 12px;
                                                }
                                        </style>

                                        <table width="100%" class="font_fam table table-nobordered font_size_14" style="text-align:center;">
                                                <tr>
                                                        <td><B>ฝ่าย/ส่วนการตลาด</B></td><br/>
                                                        <td><B>ส่วนบริการตลาดและการผลิต</B></td><br/>
                                                        <td><B>ฝ่ายการผลิต</B></td>
                                                </tr>
                                                <tr>
                                                        <td>
                                                                <span>ผู้จัดทำ/ตรวจสอบ__________________</span><br/>
                                                                <span>วันที่___________________________</span>
                                                        </td>
                                                        <td>

                                                        </td>
                                                        <td>
                                                                <span>รับทราบ________________________</span><br/>
                                                                <span>ผู้จัดการส่วนวางแผน 1</span><br/>
                                                                <span>วันที่___________________________</span>
                                                        </td>
                                                </tr>
                                                <tr>
                                                        <td>
                                                                <span>ผู้อนุมัติ_________________________</span><br/>
                                                                <span>ผู้จัดการฝ่าย/ส่วนการตลาด</span><br/>
                                                                <span>วันที่___________________________</span>
                                                        </td>
                                                        <td>
                                                                <span>รับทราบ________________________</span><br/>
                                                                <span>ส่วนบริการการตลาดและการผลิต</span><br/>
                                                                <span>วันที่___________________________</span>
                                                        </td>
                                                        <td>
                                                                <span>รับทราบ________________________</span><br/>
                                                                <span>ผู้จัดการส่วนวางแผน 2</span><br/>
                                                                <span>วันที่___________________________</span>
                                                        </td>
                                                </tr>
                                        </table>

                                </div>
                        </t>
                </t>

        </template>

</odoo>
