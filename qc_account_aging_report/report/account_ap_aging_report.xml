<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="account_ap_aging_report_id" >

        <t t-foreach="docs" t-as="o">
            <t t-call="web.basic_layout">
                <div class="header">
                    <style>
                        @font-face
                        {
                        font-family: Sarabun-Regular;
                        src: local('United'), url("/qc_account_aging_report/static/font/Sarabun-Regular.ttf") format('opentype');
                        }
                        .font_fam{
                        font-family: Sarabun-Regular;
                        src: local('United'), url("/qc_account_aging_report/static/font/Sarabun-Regular.ttf") format('opentype');
                        }
                        .word_wrap{
                        word-wrap: break-word;
                        overflow: hidden;
                        <!--background-color:#cccccc;-->
                        }
                        table.table-bordered{
                        border:1px solid black;
                        width: 100%;
                        }
                        table.table-bordered &gt; thead &gt; tr &gt; th{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; thead &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; tbody &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; tfoot &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        .font_size_32{
                        font-size: 32px;
                        line-height: 30px;
                        }
                        .font_size_28{
                        font-size: 28px;
                        line-height: 26px;
                        }
                        .font_size_22{
                        font-size: 22px;
                        line-height: 20px;
                        }
                        .font_size_20{
                        font-size: 20px;
                        line-height: 18px;
                        }
                        .font_size_18{
                        font-size: 18px;
                        line-height: 16px;
                        }
                        .font_size_16{
                        font-size: 16px;
                        line-height: 14px;
                        }
                        .font_size_14{
                        font-size: 14px;
                        line-height: 12px;
                        }
                        span{
                        line-height: inherit;
                        }
                    </style>

                    <table width="100%" class="font_fam table table-nobordered font_size_18">
                        <tr align="center">
                            <td><span t-field="o.company_id"/></td>
                        </tr>
                        <tr align="center">
                            <td><span>รายละเอียดเจ้าหนี้ค้างรับ</span></td>
                        </tr>
                        <tr align="center">
                            <td><span>ณ </span><span t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M')"/></td>
                        </tr>
                    </table>

                </div>

                <div class="page">
                    <style>
                        @font-face
                        {
                        font-family: Sarabun-Regular;
                        src: local('United'), url("/qc_account_aging_report/static/font/Sarabun-Regular.ttf") format('opentype');
                        }
                        .font_fam{
                        font-family: Sarabun-Regular;
                        src: local('United'), url("/qc_account_aging_report/static/font/Sarabun-Regular.ttf") format('opentype');
                        }
                        table.table-bordered{
                        border:1px solid black;
                        width: 100%;
                        }
                        table.table-bordered &gt; thead &gt; tr &gt; th{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; thead &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; tbody &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; tfoot &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-nobordered{
                        margin:0px;
                        margin-top:0px;
                        margin-bottom:0px;
                        width: 100%;
                        }
                        table.table-nobordered &gt; thead &gt; tr &gt; th{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered &gt; thead &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered &gt; tbody &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered &gt; tfoot &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }

                        table.table-bordered {
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; thead &gt; tr &gt; th{
                        border:1px solid black;
                        vertical-align: middle;
                        text-align:center;
                        padding:3px;
                        }
                        table.table-bordered &gt; tbody &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered &gt; tfoot &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }

                        table.table-bordered-b {
                        border:1px solid black;
                        padding:3px;
                        }
                        table.table-bordered-b &gt; thead &gt; tr &gt; th{
                        border:1px solid black;
                        vertical-align: middle;
                        text-align:center;
                        padding:3px;
                        }
                        table.table-bordered-b &gt; tbody &gt; tr &gt; td{
                        border:0px solid White;
                        border-left: 1px solid black;
                        padding:3px;
                        }
                        table.table-bordered-b &gt; tfoot &gt; tr &gt; td{
                        border:1px solid black;
                        padding:3px;
                        }

                        table.table-nobordered-b{
                        margin:0px;
                        width: 100%;
                        }
                        table.table-nobordered-b &gt; thead &gt; tr &gt; th{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered-b &gt; thead &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered-b &gt; tbody &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }
                        table.table-nobordered-b &gt; tfoot &gt; tr &gt; td{
                        border:1px solid white;
                        padding:0px;
                        }
                        .word_wrap{
                        word-wrap: break-word;
                        <!--background-color:#cccccc;-->
                        }
                        .font_size_32{
                        font-size: 32px;
                        line-height: 30px;
                        }
                        .font_size_28{
                        font-size: 28px;
                        line-height: 26px;
                        }
                        .font_size_22{
                        font-size: 22px;
                        line-height: 20px;
                        }
                        .font_size_20{
                        font-size: 20px;
                        line-height: 18px;
                        }
                        .font_size_18{
                        font-size: 18px;
                        line-height: 16px;
                        }
                        .font_size_16{
                        font-size: 16px;
                        line-height: 14px;
                        }
                        .font_size_14{
                        font-size: 14px;
                        line-height: 12px;
                        }
                    </style>

                    <table width="100%" class="font_fam table table-bordered font_size_14">
                        <tr>
                            <th colspan="14"><span>เจ้าหนี้การค้า</span></th>
                            <th colspan="3"><span>หักชำระเงินมัดจำ</span></th>
                            <th colspan="4"><span>หัก CREDIT NOTE</span></th>
                            <th colspan="4"><span>เจ้าหนี้สุทธิ ตามบัญชี</span></th>
                            <th rowspan="3"><span>ขาด/เกินวงเงิน</span></th>
                        </tr>
                        <tr>
                            <th rowspan="2"><span>วันที่รับซื้อ</span></th>
                            <th rowspan="2"><span>ชื่อผู้ขาย</span></th>
                            <th rowspan="2"><span>PI NO.</span></th>
                            <th rowspan="2"><span>จำนวนเงินตาม(PO)</span></th>
                            <th rowspan="2"><span>BIlls NO./<br/>เลขที่ใบแจ้งหนี้</span></th>
                            <th rowspan="2"><span>เงื่อนไข<br/>การชำระเงิน</span></th>
                            <th rowspan="2"><span>ระยะเวลา<br/>การชำระเงิน(วัน)</span></th>
                            <th rowspan="2"><span>วงเงินเชื่อที่<br/>ได้รับอนุมัติ</span></th>
                            <th rowspan="2"><span>วันที่ครบ<br/>กำหนด</span></th>
                            <th rowspan="2"><span>อายุเจ้าหนี้</span></th>
                            <th rowspan="2"><span>สกุลเงิน</span></th>
                            <th rowspan="2"><span>จำนวนเงินต่างประเทศ</span></th>
                            <th rowspan="2"><span>อัตราแลกเปลี่ยน<br/>แลกเปลี่ยน</span></th>
                            <th rowspan="2"><span>จำนวนเงิน<br/>(บาท)</span></th>
                            <th rowspan="2"><span>วันที่ชำระ</span></th>
                            <th rowspan="2"><span>จำนวนเงิน<br/>(ต่างประเทศ)</span></th>
                            <th rowspan="2"><span>จำนวนเงิน<br/>(บาท)</span></th>
                            <th rowspan="2"><span>วันที่ชำระ</span></th>
                            <th rowspan="2"><span>เลขที่เอกสาร</span></th>
                            <th rowspan="2"><span>จำนวนเงิน<br/>(ต่างประเทศ)</span></th>
                            <th rowspan="2"><span>จำนวนเงิน<br/>(บาท)</span></th>
                            <th colspan="2"><span>ตามBILLS</span></th>
                            <th colspan="2"><span>สะสมรายเจ้าหนี้</span></th>
                        </tr>
                        <tr>
                            <th><span>จำนวนเงิน<br/>(ต่างประเทศ)</span></th>
                            <th><span>จำนวนเงิน<br/>(บาท)</span></th>

                            <th><span>จำนวนเงิน<br/>(ต่างประเทศ)</span></th>
                            <th><span>จำนวนเงิน<br/>(บาท)</span></th>
                        </tr>
                        <t t-foreach="invoice_ids" t-as="move">
                            <tr>
                                <td>
                                    <span t-field="move.invoice_date"/>
                                </td>
                                <td>
                                    <span t-field="move.partner_id.name"/>
                                </td>
                                <td>
                                    <span t-field="move.purchase_id.name"/>
                                </td>
                                <td>
                                    <span t-esc="'{0:,.2f}'.format(move.purchase_id.amount_total)"/>
                                </td>
                                <td>
                                    <span t-field="move.name"/>
                                </td>
                                <td>
                                    <span t-field="move.invoice_payment_term_id.name"/>
                                </td>
                                <td>
                                    <span t-field="move.invoice_payment_term_id.name"/>
                                </td>
                                <t t-set="credit_limit_amount" t-value="0.0"/>
                                <td>
                                    <span t-esc="credit_limit_amount"/>
                                </td>
                                <td>
                                    <span t-field="move.invoice_date_due"/>
                                </td>
                                <t t-set="invoice_days" t-value="o._get_invoice_days(move)"/>
                                <td>
                                    <span t-esc="invoice_days"/>
                                </td>
                                <t t-if="move.company_currency_id != move.currency_id">
                                    <td align="center">
                                        <span t-field="move.currency_id"/>
                                    </td>
                                    <td align="right">
                                        <span t-esc="'{0:,.2f}'.format(move.amount_total)"/>
                                    </td>
                                    <t t-set="currency_rate" t-value="move.company_currency_id._get_rates(move.company_id, move.invoice_date).get(move.company_currency_id.id)"/>
                                    <td align="right">
                                        <span t-esc="'{0:,.2f}'.format(currency_rate)"/>
                                    </td>
                                    <t t-set="amount_currency" t-value="move.currency_id._convert(move.amount_total, move.company_currency_id, move.company_id, move.invoice_date or move.date)"/>
                                    <td align="right">
                                        <span t-esc="'{0:,.2f}'.format(amount_currency)"/>
                                    </td>
                                </t>
                                <t t-else="">
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td align="right">
                                        <span t-esc="'{0:,.2f}'.format(move.amount_total)"/>
                                    </td>
                                </t>
                                <td></td>
                                <t t-set="invoice_down_payment_amount" t-value="invoice_down_payment_amount"/>
                                <td>
                                    <span t-esc="invoice_down_payment_amount"/>
                                </td>
                                <td>
                                    <span t-esc="invoice_down_payment_amount"/>
                                </td>
                                <t t-set="credit_note_ids" t-value="o.env['account.move'].search([('reversed_entry_id', '=', move.id)])"/>
                                <t t-if="credit_note_ids">
                                    <t t-set="credit_note_id" t-value="credit_note_ids[0]"/>
                                    <td>
                                        <span t-field="credit_note_id.invoice_date"/>
                                    </td>
                                    <td>
                                        <span t-field="credit_note_id.name"/>
                                    </td>
                                    <td align="right">
                                        <span t-esc="'{0:,.2f}'.format(credit_note_id.amount_total)"/>
                                    </td>
                                    <t t-set="amount_currency" t-value="credit_note_id.currency_id._convert(credit_note_id.amount_total, credit_note_id.company_currency_id,
                                                                      credit_note_id.company_id,
                                                                      credit_note_id.invoice_date or move.date)"/>
                                    <td>
                                        <span t-esc="amount_currency"/>
                                    </td>
                                </t>
                                <t t-else="">
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </t>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </t>
                    </table>

                </div>
            </t>
        </t>

    </template>

</odoo>